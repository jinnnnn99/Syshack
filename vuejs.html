<!DOCTYPE html> <!-- ドキュメントの種類をHTML5であることを示す -->
<html lang="ja"> <!-- 言語設定-->
<head> <!-- メタ情報(ページのタイトルやCSS、スクリプトなど)を含むセクション -->
  <meta charset="UTF-8"> <!-- ドキュメントの文字エンコーディングをUTF-8に設定する-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ページのデバイスの幅に合わせて表示するための設定 -->
  <title>ログイン・登録画面</title> <!-- ページのタイトルを設定 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script> <!-- Vue.jsのライブラリをオンラインで読み込む -->
  <!-- ページのスタイル(デザインやレイアウト)を記述するセクション -->
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }

    .container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 300px;
      text-align: center;
    }

    input[type="text"], input[type="password"] {
      width: calc(100% - 20px);
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      width: 100%;
      padding: 10px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      margin: 10px 0;
    }

    .error {
      color: red;
      margin-top: 10px;
    }

    .toggle-link {
      color: #007bff;
      cursor: pointer;
      margin-top: 20px;
      display: inline-block;
    }

    h2 {
      margin-bottom: 20px;
    }
  </style>
</head>
<body> <!-- 実際にユーザーに表示されるHTMLコンテンツを含むセクション -->
  <div id="app"> <!-- Vue.jsアプリケーションのルート要素。この中に表示する各画面のコンテンツが含まれる。v-if="page" === 'login'"などのディレクティブを使い、page変数の値に応じて異なるコンテンツを表示します。ログイン画面、登録画面など複数画面が切り替え表示される仕組みとなっている。 -->
    <div class="container" v-if="page === 'login'">
      <h2>ログイン</h2>
      <input type="text" v-model="loginUsername" placeholder="ユーザー名">
      <input type="password" v-model="loginPassword" placeholder="パスワード">
      <button @click="login">ログイン</button>
      <div class="error" v-if="error">{{ error }}</div>
      <div class="toggle-link" @click="toggleForm">新規登録はこちら</div>
    </div>

    <div class="container" v-if="page === 'register'">
      <h2>新規登録</h2>
      <input type="text" v-model="registerUsername" placeholder="ユーザー名">
      <input type="password" v-model="registerPassword" placeholder="パスワード">
      <button @click="register">登録</button>
      <div class="toggle-link" @click="toggleForm">ログインはこちら</div>
    </div>

    <div class="container" v-if="page === 'select'">
      <h2>ようこそ</h2>
      <button @click="goToPage('camera')">カメラ</button>
      <button @click="goToPage('quiz-levels')">クイズ</button>
    </div>

    <!-- カメラページのコンテンツは追加課題となります -->
    <div v-if="page === 'camera'">
      <h2>カメラ機能</h2>
      <button @click="goToPage('select')">戻る</button>
      <!-- カメラ機能をここに追加 -->
    </div>

    <!-- クイズレベル選択ページのコンテンツ -->
    <div class="container" v-if="page === 'quiz-levels'">
      <h2>クイズのレベルを選択</h2>
      <button @click="selectLevel('easy')">簡単</button>
      <button @click="selectLevel('medium')">中級</button>
      <button @click="selectLevel('hard')">難しい</button>
    </div>

    <!-- クイズページのコンテンツ -->
    <div class="container" v-if="page === 'quiz'">
      <h2>クイズ</h2>
      <div v-if="!quizCompleted">
        <p>{{ currentQuestion.question }}</p>
        <ul>
          <li v-for="(option, index) in currentQuestion.options" :key="index">
            <button @click="selectOption(index)">{{ option }}</button>
          </li>
        </ul>
      </div>
    </div>

    <!-- 正解画面のコンテンツ -->
    <div class="container" v-if="page === 'result'">
      <h2>結果</h2>
      <div v-if="correct">
        <p>正解です！</p>
      </div>
      <div v-else>
        <p>不正解です。<br />正解は "{{ currentQuestion.options[currentQuestion.answer] }}" です。</p>
      </div>
      <button @click="nextQuestion">次の問題</button>
      <button @click="goToPage('select')">戻る</button>
    </div>

  </div>

  <script>
    new Vue({
      el: '#app',  // Vue.jsアプリケーションのルート要素を指定する。この場合。id属性がappである要素。
      data: function() { // Vueインスタンスのデータオブジェクトを返す関数。このデータはテンプレートでバインドされるかアプリケーションロジック(アプリケーション内でデータがどのように処理および操作されるかを定義する一連のルール、プロセス、アルゴリズムを指す)で使用される。
        return {
          loginUsername: '', // ログイン画面のユーザー名
          loginPassword: '', // ログイン画面のパスワード
          registerUsername: '', // 登録画面のユーザー名
          registerPassword: '', // 登録画面のパスワード
          users: [], // 簡単なユーザーデータベース
          error: '', // エラーメッセージ
          page: 'login', // 現在表示しているページを管理するための変数
          // 各レベルの質問の配列
          easyQuestions: [ 
            {
              question: "日本の首都はどこですか？",
              options: ["京都", "大阪", "東京", "札幌"],
              answer: 2
            }
          ],
          mediumQuestions: [
            {
              question: "国連の本部はどこにありますか？",
              options: ["ニューヨーク", "パリ", "ロンドン", "ジュネーヴ"],
              answer: 0
            }
          ],
          hardQuestions: [
            {
              question: "量子力学の基本原理を発展させた物理学者は誰ですか？",
              options: ["アイザック・ニュートン", "アルベルト・アインシュタイン", "ニールス・ボーア", "マックス・プランク"],
              answer: 2
            }
          ],
          currentQuestionSet: [], // 現在の質問セット
          currentQuestionIndex: 0, // 現在の質問のインデックス
          selectedOption: null, // 選択されたオプションのインデックス
          quizCompleted: false, // クイズが完了したかどうか
          correct: false // 正解したかどうか
        };
      },
      computed: { // Vueコンポーネントのプロパティ。データを元に動的に計算される値
        currentQuestion() { // 現在の質問を返す
          return this.currentQuestionSet[this.currentQuestionIndex];
        }
      },
      methods: { // Vue.jsアプリケーション内で使用される関数
        toggleForm() { // ログイン画面と登録画面を切り替える
          this.error = '';
          this.page = this.page === 'login' ? 'register' : 'login';
        },
        login() { // ユーザー名とパスワードをチェックしてログインする
          const user = this.users.find(
            (user) => user.username === this.loginUsername && user.password === this.loginPassword
          );
          if (user) {
            this.page = 'select';
            this.error = '';
          } else {
            this.error = 'ユーザー名またはパスワードが違います';
          }
        },
        register() { // ユーザー名とパスワードを登録する
          if (this.registerUsername && this.registerPassword) {
            this.users.push({
              username: this.registerUsername,
              password: this.registerPassword,
            });
            this.error = '';
            this.page = 'login';
          } else {
            this.error = '全てのフィールドを入力してください';
          }
        }, 
        goToPage(page) { // 指定したページに移動する
          this.page = page;
          if (page === 'quiz') {
            this.resetQuiz();
          }
        },
        selectLevel(level) { // クイズのレベルを選択し、クイズ画面に移動
          if (level === 'easy') {
            this.currentQuestionSet = this.easyQuestions;
          } else if (level === 'medium') {
            this.currentQuestionSet = this.mediumQuestions;
          } else if (level === 'hard') {
            this.currentQuestionSet = this.hardQuestions;
          }
          this.page = 'quiz';
          this.resetQuiz();
        },
        selectOption(index) { // クイズの選択肢を選択したら、結果画面に移動
          if (this.selectedOption === null) {
            this.selectedOption = index;
            this.correct = index === this.currentQuestion.answer;
            this.quizCompleted = true;
            this.page = 'result';
          }
        },
        nextQuestion() { // 次の質問に進むかクイズを終了したら、選択画面に移動
          this.currentQuestionIndex++;
          if (this.currentQuestionIndex >= this.currentQuestionSet.length) {
            alert("全部の問題が終わりました！");
            this.goToPage('select');
          } else {
            this.quizCompleted = false;
            this.selectedOption = null;
            this.page = 'quiz';
          }
        },
        resetQuiz() { // クイズの状態をリセット
          this.currentQuestionIndex = 0;
          this.selectedOption = null;
          this.quizCompleted = false;
          this.correct = false;
        }
      }
    });
  </script>
</body>
</html>
